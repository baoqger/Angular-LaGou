"use strict";function favoriteCtrl(t){this.favoritePosition=t}function loginCtrl(t,i){this.login=function(){i.put("loginStatus",!0),t.go("main")}}function meCtrl(t,i,e){this.loginStatus=e,this.logout=function(){t.remove("loginStatus"),i.go("main")}}function postCtrl(t){this.tabList=[{id:"all",name:"全部"},{id:"pass",name:"面试"},{id:"fail",name:"不合适"}],this.tClick=function(t){console.log(t)}.bind(this),this.postPosition=t}function registerCtrl(t,i){this.submit=function(){console.log(this.user)},this.send=function(){t.getVerifyCode().then(function(t){if(t.data.state){this.time="60s";var e=60,o=i(function(){e<=0?(i.cancel(o),this.time=""):(e--,this.time=e+"s")}.bind(this),1e3)}}.bind(this))}}function searchCtrl(t,i,e,o,n,r){console.log("search controller..."),this.Tablist=r.getTabList(),this.list=t,this.search=function(i){console.log("clicked..."),this.list=n.searchPosition(t,i)},this.cancelSearch=function(){this.name="",this.list=t},this.tClick=function(t){this.filterList=n.getFilterListByID(t,i,e,o),this.filterListVisible=!0,this.currentTabId=t}.bind(this),this.setCurrentFilterObj=function(t,i){this.currentFilterObj=n.getCurrentFilterObj(this.currentFilterObj||{},t,i),this.Tablist=r.updateTabList(this.Tablist,this.filterList,t,i)}.bind(this)}function appPositionClassCtrl(t){this.$onInit=function(){this.getCurrentPosi=function(i){this.currentpositionlist=t.getPositionListByClass(i,this.companyInfo),this.currentPositionClass=i}}}function appPositionClassDirective(){return{restrict:"A",replace:!0,templateUrl:"view/template/positionClass.html",scope:{positionClass:"=",companyInfo:"=",currentPositionClass:"="},bindToController:!0,controller:"appPositionClassCtrl",controllerAs:"posiClass",link:function(t,i,e,o){t.$watch("posiClass.positionClass",function(i,e){i!==e&&o.getCurrentPosi(t.posiClass.positionClass[0])})}}}function appPositionInfoCtrl(t){this.$onInit=function(){this.loginStatus=t.get("loginStatus"),this.addFavorite=function(i){this.favoriteStatus=!this.favoriteStatus,t.addToFavoriteCacheList(i)},this.removeFavorite=function(i){this.favoriteStatus=!this.favoriteStatus,t.removeFromFavoriteCacheList(i)},this.checkFavoriteStatus=function(i){this.favoriteStatus=t.checkFavoriteStatus(i)}}}function appPositionInfo(){return{restrict:"A",replace:!0,templateUrl:"view/template/positionInfo.html",scope:{isActive:"=",isLogin:"=",pos:"="},controller:appPositionInfoCtrl,controllerAs:"posiInfo",bindToController:!0,link:function(t,i,e,o){t.$watch("posiInfo.pos",function(i,e){i!==e&&(console.log("data loaded"+t.posiInfo.pos.id),o.checkFavoriteStatus(t.posiInfo.pos.id))})}}}function appSheetCtrl(){this.$onInit=function(){this.closeFilterList=function(){this.visible=!1}.bind(this)}}function appSheet(){return{restrict:"A",replace:!0,templateUrl:"view/template/sheet.html",scope:{visible:"=",filterList:"=",getFilterObj:"=",tabId:"="},controller:"appSheetCtrl",controllerAs:"sheet",bindToController:!0}}function appTabCtrl(){this.$onInit=function(){this.click=function(t,i){this.selectedTabID=t,this.tabClick(t)}.bind(this)}}function appTab(){return{restrict:"A",replace:!0,templateUrl:"view/template/tab.html",scope:{tabList:"=",tabClick:"="},controller:"appTabCtrl",controllerAs:"tab",bindToController:!0}}angular.module("app",["ui.router","ngCookies","validation"]),angular.module("app").config(["$provide",function(t){}]),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(t,i){t.state("main",{url:"/main",templateUrl:"view/main.html",controller:"mainCtrl as main"}).state("position",{url:"/position/:id",templateUrl:"view/position.html",controller:"positionCtrl as position"}).state("company",{url:"/company/:id",templateUrl:"view/company.html",controller:"companyCtrl as company"}).state("search",{url:"/search",templateUrl:"view/search.html",controller:"searchCtrl as search",resolve:searchCtrl.resolve}).state("me",{url:"/me",templateUrl:"view/me.html",controller:"meCtrl as me",resolve:meCtrl.resolve}).state("login",{url:"/login",templateUrl:"view/login.html",controller:"loginCtrl as login"}).state("register",{url:"/register",templateUrl:"view/register.html",controller:"registerCtrl as register"}).state("favorite",{url:"/favorite",templateUrl:"view/favorite.html",controller:"favoriteCtrl as favorite",resolve:favoriteCtrl.resolve}).state("post",{url:"/post",templateUrl:"view/post.html",controller:"postCtrl as post",resolve:postCtrl.resolve}),i.otherwise("main")}]),angular.module("app").config(["$validationProvider",function(t){var i={phone:/^1[\d]{10}$/,password:function(t){var i=t+"";return i.length>5}},e={phone:{success:"",error:"必须是11位手机号"},password:{success:"",error:"长度至少6位"}};t.setExpression(i).setDefaultMsg(e)}]),angular.module("app").controller("companyCtrl",["dataService","dataFilterService","$state",function(t,i,e){console.log("company controll..."),t.getCompInfoById().then(function(t){this.company=i.filterByCompId(t.data,e.params.id),this.positionclass=i.positionClassForCompany(this.company),this.currentPosiClass=this.positionclass[0]}.bind(this))}]),favoriteCtrl.resolve={favoritePosition:function(t){return t.getFavoritePosition()}},angular.module("app").controller("favoriteCtrl",favoriteCtrl),angular.module("app").controller("loginCtrl",loginCtrl),angular.module("app").controller("mainCtrl",["dataService",function(t){console.log("main controller"),this.list=[],t.getPositionList().then(function(t){this.list=t.data}.bind(this))}]),meCtrl.resolve={loginStatus:function(t){return t.get("loginStatus")}},angular.module("app").controller("meCtrl",meCtrl),angular.module("app").controller("positionCtrl",["$scope","cache","dataService","dataFilterService","$state",function(t,i,e,o,n){this.position={},this.company={},e.getPosiInfoById().then(function(t){this.position=o.filterById(t.data,n.params.id);var i=this.position.companyId;e.getCompInfoById().then(function(t){this.company=o.filterByCompId(t.data,i)}.bind(this))}.bind(this)),this.loginStatus=i.get("loginStatus"),this.submitStatus=i.checkSubmitStatus(n.params.id),this.submitResume=function(){i.addToSubmitHistory(n.params.id),this.submitStatus=i.checkSubmitStatus(n.params.id)}.bind(this)}]),postCtrl.resolve={postPosition:function(t){return t.getPostPosition()}},angular.module("app").controller("postCtrl",postCtrl),angular.module("app").controller("registerCtrl",registerCtrl),searchCtrl.resolve={globalCity:function(t){return t.getJSONData("data/city.json")},globalSalary:function(t){return t.getJSONData("data/salary.json")},globalScale:function(t){return t.getJSONData("data/scale.json")},position:function(t){return t.getPositionListNew()}},angular.module("app").controller("searchCtrl",searchCtrl),angular.module("app").directive("appCompany",[function(){return{restrict:"A",replace:!0,templateUrl:"view/template/company.html",scope:{comp:"="}}}]),angular.module("app").directive("appFoot",[function(){return{restrict:"A",replace:!0,templateUrl:"view/template/foot.html"}}]),angular.module("app").directive("appHead",["cache",function(t){return{restrict:"A",replace:!0,templateUrl:"view/template/head.html",controller:function(){},controllerAs:"head",bindToController:!0,link:function(i){i.head.loginStatus=t.get("loginStatus")}}}]),angular.module("app").directive("appHeadBar",[function(){return{restrict:"A",replace:!0,templateUrl:"view/template/headBar.html",scope:{text:"="},link:function(t){t.back=function(){window.history.back(),console.log(t.text)}}}}]),angular.module("app").directive("appPositionClass",appPositionClassDirective).controller("appPositionClassCtrl",appPositionClassCtrl),angular.module("app").directive("appPositionInfo",appPositionInfo).controller("appPositionInfoCtrl",appPositionInfoCtrl),angular.module("app").directive("appPositionList",[function(){return{restrict:"A",replace:!0,templateUrl:"view/template/positionList.html",scope:{data:"=",filterObj:"="},controller:function(){},controllerAs:"posiList",bindToController:!0}}]),angular.module("app").directive("appSheet",appSheet).controller("appSheetCtrl",appSheetCtrl),angular.module("app").directive("appTab",appTab).controller("appTabCtrl",appTabCtrl),angular.module("app").service("cache",["$cookies",function(t){this.put=function(i,e){t.put(i,e)},this.get=function(i){return t.get(i)},this.remove=function(i){t.remove(i)},this.addToSubmitHistory=function(i){Object.keys(t.getAll()).indexOf("submitHistory")<0&&t.put("submitHistory",JSON.stringify([]));var e=JSON.parse(t.get("submitHistory"));console.log(e),e.indexOf(i)<0&&(e.push(i),t.put("submitHistory",JSON.stringify(e)))},this.checkSubmitStatus=function(i){if(Object.keys(t.getAll()).indexOf("submitHistory")>=0){var e=JSON.parse(t.get("submitHistory"));return e.indexOf(i)>=0}},this.getPostPositionId=function(){return Object.keys(t.getAll()).indexOf("submitHistory")>=0?JSON.parse(t.get("submitHistory")):[]},this.checkFavoriteStatus=function(i){return Object.keys(t.getAll()).indexOf("favoriteList")>=0&&JSON.parse(t.get("favoriteList")).indexOf(i)>=0},this.addToFavoriteCacheList=function(i){Object.keys(t.getAll()).indexOf("favoriteList")<0&&t.put("favoriteList",JSON.stringify([]));var e=JSON.parse(t.get("favoriteList"));console.log(e),e.indexOf(i)<0&&(e.push(i),t.put("favoriteList",JSON.stringify(e)))},this.removeFromFavoriteCacheList=function(i){var e=JSON.parse(t.get("favoriteList")),o=e.indexOf(i);e.splice(o,1),t.put("favoriteList",JSON.stringify(e))},this.getFavoritePositionId=function(){return Object.keys(t.getAll()).indexOf("favoriteList")>=0?JSON.parse(t.get("favoriteList")):[]}}]),angular.module("app").service("dataFilterService",["$http",function(t){this.filterById=function(t,i){for(var e=0;e<t.length;e++)if(t[e].id===i)return t[e]},this.filterByCompId=function(t,i){for(var e=0;e<t.length;e++)if(t[e].id===i)return t[e]},this.positionClassForCompany=function(t){var i=[];return t.positionClass.forEach(function(t){i.push(t.name)}),i},this.getPositionListByClass=function(t,i){console.log("call getPositionListByClass...");for(var e=0;e<i.positionClass.length;e++){var o=i.positionClass[e];if(o.name===t){var n=o.positionList;break}}return n},this.getFilterListByID=function(t,i,e,o){return"city"===t?i:"salary"===t?e:o},this.getCurrentFilterObj=function(t,i,e){return Object.keys(t).indexOf(e+"Id")>=0?""===i?delete t[e+"Id"]:t[e+"Id"]=i:""!==i&&(t[e+"Id"]=i),t},this.searchPosition=function(t,i){var e=[];console.log(t);for(var o=0;o<t.length;o++)(t[o].job.search(i)>=0||t[o].companyName.search(i)>=0)&&e.push(t[o]);return e}}]),angular.module("app").service("dataService",["$http","cache",function(t,i){this.getPositionList=function(){return t.get("/data/positionList.json")},this.getPositionListNew=function(){return t.get("/data/positionList.json").then(function(t){return t.data})},this.getPosiInfoById=function(){return t.get("data/positionList.json")},this.getCompInfoById=function(){return t.get("data/companyList.json")},this.getJSONData=function(i){return t.get(i).then(function(t){return t.data})},this.getTabList=function(){return[{id:"city",name:"城市"},{id:"salary",name:"薪水"},{id:"scale",name:"公司规模"}]},this.updateTabList=function(t,i,e,o){var n="";return i.forEach(function(t){t.id===e&&(n=t.name)}),t.forEach(function(t){t.id===o&&(t.name=n)}),t},this.getVerifyCode=function(){return t.get("data/code.json")},this.getPostPosition=function(){var e=i.getPostPositionId();return t.get("data/positionList.json").then(function(t){for(var i=[],o=0;o<t.data.length;o++)e.indexOf(t.data[o].id)>=0&&i.push(t.data[o]);return i})},this.getFavoritePosition=function(){var e=i.getFavoritePositionId();return t.get("data/positionList.json").then(function(t){for(var i=[],o=0;o<t.data.length;o++)e.indexOf(t.data[o].id)>=0&&i.push(t.data[o]);return i})}}]);